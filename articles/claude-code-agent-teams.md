---
title: "Claude Code Agent Teams入門 - 複数のAIエージェントを協調させる新しい開発手法"
emoji: "🤖"
type: "tech"
topics: ["claudecode", "ai", "agentteams", "開発効率化", "llm"]
published: false
---

## はじめに

Claude Codeに新しく追加された「Agent Teams」機能は、複数のClaude Codeインスタンスをチームとして協調させることで、複雑なタスクを並列で処理できる革新的な機能です。

本記事では、Agent Teamsの基本概念から実践的な使い方まで、体系的に解説します。

## Agent Teamsとは

Agent Teamsは、1つのセッション（チームリード）が複数のClaude Codeインスタンス（チームメイト）を生成・管理し、それぞれが独自のコンテキストウィンドウで作業を行う仕組みです。

### サブエージェントとの違い

| 特徴 | サブエージェント | Agent Teams |
|------|------------------|-------------|
| コンテキスト | 独自のコンテキスト、結果は呼び出し元へ | 独自のコンテキスト、完全に独立 |
| コミュニケーション | メインエージェントへの報告のみ | チームメイト間で直接メッセージ |
| 調整方法 | メインエージェントが全て管理 | 共有タスクリストで自己調整 |
| 最適な用途 | 結果のみが重要な集中タスク | 議論と協調が必要な複雑な作業 |
| トークンコスト | 低い | 高い（各チームメイトが独立インスタンス） |

## Agent Teamsの有効化

Agent Teamsはデフォルトで無効になっています。有効化するには、`settings.json`に以下を追加します：

```json
{
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  }
}
```

## 最適なユースケース

### 1. 研究・レビュー作業

複数のチームメイトが問題の異なる側面を同時に調査し、発見を共有・検証できます。

```
PRR #142をレビューするAgent Teamを作成してください。3人のレビュアーを生成：
- セキュリティに焦点を当てた担当
- パフォーマンス影響をチェックする担当
- テストカバレッジを検証する担当
```

### 2. 新機能・モジュール開発

各チームメイトが互いに干渉することなく、独立した部分を担当できます。

### 3. 競合仮説によるデバッグ

異なる理論を並行してテストし、より速く答えに収束できます。

```
アプリが1メッセージで終了する問題を調査するため、5つのAgent Teamを生成。
異なる仮説を調査し、科学的議論のように互いの理論を反証し合う。
```

### 4. クロスレイヤー調整

フロントエンド、バックエンド、テストなど、異なる層にまたがる変更を各担当が所有できます。

## 表示モード

Agent Teamsは2つの表示モードをサポートしています：

### インプロセスモード

すべてのチームメイトがメインターミナル内で実行されます。Shift+Up/Downでチームメイトを選択できます。

### 分割ペインモード

各チームメイトが専用のペインを持ちます。tmuxまたはiTerm2が必要です。

```json
{
  "teammateMode": "in-process"
}
```

## タスク管理

共有タスクリストがチーム全体の作業を調整します：

- **リードが割り当て**: リードが特定のタスクを特定のチームメイトに割り当て
- **自己クレーム**: タスク完了後、チームメイトが次の未割り当てタスクを自動で取得

タスクには依存関係を設定でき、依存タスクが完了するまでブロックされます。

## ベストプラクティス

### 1. 十分なコンテキストを提供

チームメイトはプロジェクトコンテキストを自動でロードしますが、リードの会話履歴は引き継ぎません：

```
セキュリティレビュー担当をスポーン。プロンプト: "src/auth/の認証モジュールを
脆弱性についてレビュー。トークン処理、セッション管理、入力検証に焦点を当てる。"
```

### 2. 適切なタスクサイズ

- **小さすぎる**: 調整オーバーヘッドが効果を上回る
- **大きすぎる**: チェックインなしで長時間作業、無駄な作業のリスク増加
- **ちょうど良い**: 明確な成果物を生み出す自己完結した単位

### 3. ファイル競合を避ける

2人のチームメイトが同じファイルを編集すると上書きが発生します。各チームメイトが異なるファイルセットを所有するように作業を分割しましょう。

## 制限事項

現在の制限事項を把握しておくことが重要です：

- インプロセスチームメイトではセッション再開が機能しない
- タスクステータスが遅延することがある
- シャットダウンに時間がかかることがある
- セッションごとに1チームのみ
- ネストされたチームは不可
- チームメイトはリードの権限設定を継承

## まとめ

Claude Code Agent Teamsは、複雑なタスクを並列で効率的に処理するための強力な機能です。研究・レビュー、新機能開発、デバッグなど、並列探索が価値を生むタスクで特に効果を発揮します。

なお、本記事で紹介したAgent Teamsのような複数エージェント協調の考え方は、オープンソースプロジェクト「OpenClaw」でも活用されています。OpenClawは、AIエージェントの協調動作やワークフロー自動化を研究・実践するプロジェクトで、興味のある方はぜひチェックしてみてください。

## 参考リンク

- [Claude Code Agent Teams公式ドキュメント](https://code.claude.com/docs/en/agent-teams)
- [Claude Code サブエージェント](https://code.claude.com/docs/en/sub-agents)
